
```{r}
# Load library
library(rayrender)

# Generate ground
scene=generate_ground()

# Freezer matrix
freezer=matrix(c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,0,0,5,5,7,7,9,9,7,5,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,0,5,6,7,7,7,8,8,9,9,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,0,5,6,7,7,5,5,5,6,7,9,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,5,6,8,8,6,8,5,5,8,7,7,9,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,5,5,3,9,8,6,6,5,5,8,7,9,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,5,2,3,3,9,9,8,6,6,6,7,9,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,1,2,2,3,3,9,9,8,5,7,9,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,1,1,1,3,9,9,9,9,3,5,4,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,1,2,9,3,1,1,1,9,9,9,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,0,1,3,2,9,1,9,10,1,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,0,1,1,2,3,9,1,1,9,9,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,0,0,1,1,3,1,9,9,9,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,                     
                 0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,9,6,5,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,1,1,9,9,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,0,0,0,0,0,1,1,2,2,3,2,1,1,2,5,4,0,0,0,0,0,0,1,1,4,4,4,4,9,1,1,1,1,1,1,1,1,
                 0,0,0,0,0,0,0,0,0,4,4,3,2,2,1,1,1,1,1,1,1,6,1,1,1,1,1,1,2,9,5,8,9,9,4,9,9,9,9,9,9,9,1,
                 0,0,0,0,0,0,0,0,4,6,7,5,3,3,9,9,9,9,1,9,3,2,3,3,9,9,9,3,1,9,2,5,5,5,4,2,9,2,1,1,1,1,1,
                 0,0,0,0,0,0,0,4,6,7,7,5,3,2,3,9,9,9,9,1,9,3,2,9,9,9,3,3,1,2,9,9,2,1,1,1,9,1,2,2,1,0,0,
                 0,0,0,0,0,0,0,4,8,8,5,9,2,1,2,3,3,2,5,5,5,4,2,3,3,3,2,1,1,1,1,1,1,9,9,1,2,9,1,3,1,0,0,
                 0,0,0,0,0,0,0,1,3,9,9,2,1,2,1,1,1,5,6,7,9,4,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,
                 0,0,0,0,0,0,1,2,3,3,1,1,2,2,3,9,9,5,8,8,7,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,1,3,3,9,3,1,1,1,2,3,3,9,5,5,4,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,1,3,3,9,3,1,0,0,1,1,2,1,1,9,1,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,1,1,3,1,1,0,0,0,0,1,1,1,3,9,9,9,2,9,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,4,9,1,1,0,0,0,0,0,0,1,2,3,3,3,9,2,9,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,4,6,5,9,1,0,0,0,0,0,1,1,1,3,3,3,9,2,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,4,8,5,3,1,0,0,0,0,0,1,9,9,2,3,3,3,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,4,8,5,3,1,0,0,0,0,1,1,3,3,9,3,3,3,3,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,4,5,3,1,0,0,0,0,0,1,2,9,9,3,2,3,3,2,1,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,1,1,1,1,0,0,0,0,0,1,3,9,9,3,1,2,2,1,9,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,1,2,3,9,1,0,0,0,0,0,1,9,9,9,2,1,1,1,2,9,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,1,2,9,1,3,1,0,0,0,0,1,9,9,9,2,1,1,2,9,9,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,1,2,9,1,2,1,0,0,0,0,1,9,9,3,1,1,1,2,9,9,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,1,3,9,1,0,0,0,0,1,2,9,9,3,1,1,1,2,3,9,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 1,1,1,0,0,1,1,0,0,0,0,0,1,3,3,3,2,1,2,1,2,3,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,1,3,1,0,0,0,0,0,0,0,0,1,2,9,2,1,1,2,1,2,2,9,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,1,3,1,0,0,0,0,0,0,0,1,2,3,1,1,2,2,1,2,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,1,3,1,0,0,0,0,0,0,1,1,1,1,2,1,2,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,1,3,1,0,0,0,0,0,1,3,3,2,1,1,2,1,2,3,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,1,3,1,0,0,0,0,1,4,5,5,2,1,2,1,1,2,5,6,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,1,3,3,1,0,0,1,2,4,6,5,2,1,1,1,1,2,5,7,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,1,2,9,3,1,1,3,4,5,6,5,2,1,1,0,1,2,5,6,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,1,3,9,9,9,9,4,5,5,2,1,1,0,0,0,1,2,6,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,1,2,3,9,3,2,4,5,5,2,1,0,0,0,0,1,2,6,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,1,1,2,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,1,1,1,3,2,3,2,3,1,0,0,0,1,3,2,3,2,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,0,1,9,3,1,9,3,1,2,9,1,0,1,3,2,1,2,3,9,9,9,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,1,3,2,1,9,2,1,0,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                 0,0,0,0,0,1,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),
            ncol=43, byrow=TRUE)

# Freezer colors
freezer1="#808080"
freezer2="#C0C0C0" 
freezer3="#DCDCDC"
freezer4="#4B0082"
freezer5="#800080"
freezer6="#BA55D3"
freezer7="#DDA0DD"
freezer8="#9400D3"
freezer9="white"
freezer10="red"

# Generate Freezer colors
for(i in 1:ncol(freezer)) {
  for(j in 1:nrow(freezer)) {
    if(freezer[j,i]!=0) {
      if(freezer[j,i]==1) {
        colorval=freezer1
        material=diffuse(color=colorval)
      } else if (freezer[j,i]==2) {
        colorval=freezer2
        material=diffuse(color=colorval)
      } else if (freezer[j,i]==3) {
        colorval=freezer3
        material=diffuse(color=colorval)      
      } else if (freezer[j,i]==4) {
        colorval=freezer4
        material=diffuse(color=colorval)
      } else if (freezer[j,i]==5) {
        colorval=freezer5
        material=diffuse(color=colorval)   
      } else if (freezer[j,i]==6) {
        colorval=freezer6
        material=diffuse(color=colorval)  
      } else if (freezer[j,i]==7) {
        colorval=freezer7
        material=diffuse(color=colorval)   
      } else if (freezer[j,i]==8) {
        colorval=freezer8
        material=diffuse(color=colorval)   
      } else if (freezer[j,i]==9) {
        colorval=freezer9
        material=diffuse(color=colorval)   
      } else if (freezer[j,i]==10) {
        colorval=freezer10
        material=diffuse(color=colorval)   
      }
      
      # Add object
      scene=add_object(scene, cube(y=48-j, z=i-40, material=material))
    }
  }
}

# Light
scene= scene %>% 
  add_object(sphere(x=-50, y=100, z=15, radius=30, material=light(intensity=10)))

# Render scene
#par(mfrow=c(1,1))
#render_scene(scene, fov=30, width=1000, height=750, samples=500,
#             parallel=TRUE, lookfrom=c(-120,35,0), lookat=c(0,25,0))

 

# Generate animation
frames=50

av::av_capture_graphics(expr={
  for(i in 1:frames) {
    
    # Red light
    scene= scene %>% 
    add_object(sphere(x=0, y=32, z=18, radius=1+i/5, material=light(intensity=10,
                                                              color="#FF0000")))
    render_scene(scene, width=1000, height=750, fov=35,
                 lookfrom=c(-120,35,0),
                 lookat=c(0,25,0), samples=1000, parallel=TRUE)
  }
}, width=500,height=500, framerate=60, output="freezer.mp4")
```


